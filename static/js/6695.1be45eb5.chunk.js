"use strict";(self.webpackChunktest_app=self.webpackChunktest_app||[]).push([[6695],{4429:(e,t,r)=>{r.d(t,{A:()=>u});var n=r(6326),o=r(42553),i=r(46053),s=r(87990),l=r(29067),a=r(84144);let u=class extends o.o{constructor(e){super(e),this.to=null,this.contents=null,this.portalUrl="https://www.arcgis.com",this.translator="esri",this.from=null,this.apiKey=null,this.requestSource=null}};(0,n.Cg)([(0,i.MZ)({type:[String],json:{write:!0}})],u.prototype,"to",void 0),(0,n.Cg)([(0,i.MZ)({type:[a.A],json:{write:!0}})],u.prototype,"contents",void 0),(0,n.Cg)([(0,i.MZ)({type:String,json:{write:!0}})],u.prototype,"portalUrl",void 0),(0,n.Cg)([(0,i.MZ)({type:String,json:{write:!0,default:"esri"}})],u.prototype,"translator",void 0),(0,n.Cg)([(0,i.MZ)({type:String,json:{write:!0}})],u.prototype,"from",void 0),(0,n.Cg)([(0,i.MZ)(l.K)],u.prototype,"apiKey",void 0),(0,n.Cg)([(0,i.MZ)({type:String,json:{name:"x-esri-request-source"}})],u.prototype,"requestSource",void 0),u=(0,n.Cg)([(0,s.$)("esri.rest.support.TranslateParameters")],u)},7061:(e,t,r)=>{r.d(t,{T:()=>l});var n=r(89379),o=r(3825),i=r(54994),s=r(73272);async function l(e,t,r){const l=t.toJSON();l.contents=JSON.stringify(l.contents),l.token=await(0,i.gf)(t.portalUrl,t.apiKey,{signal:null===r||void 0===r?void 0:r.signal,prompt:"no-prompt"!==(null===r||void 0===r?void 0:r.authMode)});const a=(0,i.Dl)(e),u=(0,i.jV)(a.query,(0,n.A)((0,n.A)({},r),{},{query:l,method:"post",authMode:"anonymous"}));return(await(0,o.A)(a.path,u)).data.results.map(e=>s.A.fromJSON(e))}},29067:(e,t,r)=>{r.d(t,{K:()=>n});const n={type:String,json:{read:{source:"token"},write:{target:"token"}}}},43317:(e,t,r)=>{r.d(t,{A:()=>_,B:()=>w,P:()=>m,g:()=>T,r:()=>F});var n=r(89379),o=r(66240),i=r(67253),s=r(9861),l=r(43036),a=r(50076),u=r(76460),c=r(87663),p=r(65308),y=r(7061),d=r(84144),g=r(4429),f=r(73272),h=r(85632);class m{constructor(e,t){this.portal=e,this._debugLog=t}async translate(e){var t;this.portal.loaded||await this.portal.load();const r=null===(t=this.portal.helperServices)||void 0===t?void 0:t.aiUtilityServices;if(null==r)return{success:!1};const n=r.url+r.translateUtility;try{var o;return null!==(o=e.requestSource)&&void 0!==o||(e.requestSource="arcade"),{success:!0,results:(await(0,y.T)(n,e,{authMode:"no-prompt"})).map(e=>e.toJSON())}}catch(i){return null!=this._debugLog&&(i instanceof Error||i instanceof a.A)&&this._debugLog("TranslateText error: ".concat(i.message)),u.A.getLogger("esri.arcade.functions.aiServices").error(i),{success:!1}}}}class v{constructor(e,t,r){this._parameters=e,this._maxTotalContentSize=t,this._maxContentsLength=r,this._requests=[],this._normalizedContents=new Map,this._contentsTotalSize=0}tryAdd(e){var t;const r=new Set(e.filter(e=>!this._normalizedContents.has(e.text)).map(e=>e.text));if(this._requests.length+r.size>this._maxContentsLength)return null;let n=0;for(const i of r)n+=i.length;if((n+this._contentsTotalSize)*(null!==(t=this._parameters.to.length)&&void 0!==t?t:1)>this._maxTotalContentSize)return null;const o=this._requests.length;for(const{key:i,text:s}of e)(0,c.tE)(this._normalizedContents,s,()=>[]).push({batchIdx:o,key:i});return this._requests.push(e),this._contentsTotalSize+=n,o}async send(e){const t=[],r=[];let o=0;for(const[n,a]of this._normalizedContents)t.push(new d.A({key:String(o++),text:n})),r.push(a);const i=new g.A(this._parameters);i.contents=t;const s=await e.translate(i);if(!s.success)return Array.from(this._requests,()=>s);const l=Array.from(this._requests,()=>({success:!0,results:[]}));for(const a of s.results){const e=Number(a.key);for(const t of r[e])l[t.batchIdx].results.push((0,n.A)((0,n.A)({},a),{},{key:t.key}))}return l}}function T(e){var t,r;const n=[...new Set(e.to)].sort(),o=null!==(t=e.from)&&void 0!==t?t:null,i=e.portalUrl,s=e.translator,l=null!==(r=e.apiKey)&&void 0!==r?r:null;return JSON.stringify([n,o,i,s,l])}async function S(e,t,r){try{return(await e.yieldFor(r))[t]}catch(n){return{success:!1}}}class w{constructor(e,t){let{maxTotalContentSize:r=5e4,maxContentsLength:n=1e3}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._executor=e,this._service=t,this._openBatches=new Map,this._maxTotalContentSize=r,this._maxContentsLength=n}create(e){return{translate:async t=>{const r=T(t),{contents:n,to:o,from:i,translator:s,portalUrl:l,apiKey:a}=t;if(null==o)return{success:!1};if(null==n||n.every(e=>0===e.text.length))return{success:!1};const u=this._openBatches.get(r);if(null!=u){const t=u.data.tryAdd(n);if(null!=t)return await S(e,t,u);u.send()}const c=new v({to:o,from:i,translator:s,portalUrl:l,apiKey:a},this._maxTotalContentSize,this._maxContentsLength),p=c.tryAdd(n);if(null!=p){const t=this._executor.openBatch(c,{open:e=>{this._openBatches.set(r,e)},execute:e=>e.send(this._service),close:e=>{this._openBatches.get(r)===e&&this._openBatches.delete(r)}});return await S(e,p,t)}return await this._service.translate(t)}}}}function F(e){"async"===e.mode&&(e.functions[(0,o.X)("TranslateText")]=function(t,r){return e.standardFunctionAsync(t,r,async(e,t,r)=>{var o,a,u;if((0,l.B)(r,2,3,e,t),!(0,h.Kg)(r[0])&&!(0,h.cy)(r[0])&&!(0,l.j)(r[0]))throw new s.D$(e,"InvalidParameter",t);const c=(0,l.M)(r[0]);if(!(0,h.Kg)(r[1])&&!(0,h.cy)(r[1])&&!(0,l.j)(r[1]))throw new s.D$(e,"InvalidParameter",t);const y=(0,l.M)(r[1]);let v=null;if(r.length>=3){if(!(0,h.Kg)(r[2]))throw new s.D$(e,"InvalidParameter",t);v=r[2]}const S=c.map((e,t)=>new d.A({key:String(t),text:e})),w=null!==(o=null===(a=e.services)||void 0===a?void 0:a.portal)&&void 0!==o?o:p.A.getDefault(),F=new g.A({to:y,contents:S,from:v,portalUrl:w.restUrl.replace(/\/sharing\/rest$/,"")}),_=new Map;let x=null;if(null!=e.lrucache){var C;const t=e.lrucache;null!==x&&void 0!==x||(x=T(F)),F.contents=null===(C=F.contents)||void 0===C?void 0:C.filter(e=>{const r=t.getCachedTranslation(x,e.text);return null==r||(_.set(e.key,(0,n.A)((0,n.A)({},r),{},{key:e.key,text:e.text})),!1)})}if(null!==(u=F.contents)&&void 0!==u&&u.length){var b,A;const t=null!==(b=null===(A=e.services)||void 0===A?void 0:A.translation)&&void 0!==b?b:new m(w,e.console),r=await t.translate(F);if(!r.success)return new i.A({__proto__:null,success:!1});for(const n of r.results){var O;const t=null===(O=F.contents)||void 0===O||null===(O=O.find(e=>e.key===n.key))||void 0===O?void 0:O.text;if(null==t)throw new s.D$(null,"NeverReach",null);_.set(n.key,n),null!=e.lrucache&&(null!==x&&void 0!==x||(x=T(F)),e.lrucache.setCachedTranslation(x,t,{detectedLanguage:n.detectedLanguage,translation:n.translation}))}}const k=Array.from(S,t=>{var r;const n=f.A.fromJSON(_.get(t.key));if(null==n)throw new s.D$(null,"NeverReach",null);return n.text=t.text,i.A.convertJsonToArcade(n.toJSON(),null!==(r=e.timeZone)&&void 0!==r?r:"system",!0)});return new i.A({__proto__:null,success:!0,results:k})})})}const _=Object.freeze(Object.defineProperty({__proto__:null,BatchTranslationServiceFactory:w,PortalTranslationService:m,getTranslateParametersKey:T,registerFunctions:F},Symbol.toStringTag,{value:"Module"}))},58889:(e,t,r)=>{r.r(t),r.d(t,{BatchTranslationServiceFactory:()=>n.B,PortalTranslationService:()=>n.P,getTranslateParametersKey:()=>n.g,registerFunctions:()=>n.r});r(66240),r(67253),r(9861),r(43036),r(50076),r(76460),r(65308),r(7061),r(84144),r(4429),r(73272);var n=r(43317)},64379:(e,t,r)=>{r.d(t,{$P:()=>c,At:()=>v,JB:()=>S,Lk:()=>p,NI:()=>w,Qi:()=>T,eB:()=>F,eg:()=>g,f0:()=>d,gO:()=>f,ik:()=>h,ke:()=>a,nE:()=>u,rX:()=>y,yT:()=>m});var n=r(46405),o=r(16503),i=r(14902),s=r(44135),l=r(40028);function a(e){return s.A.fromJSON(e.toJSON())}function u(e){return e.toJSON?e.toJSON():e}function c(e){return e instanceof Date}function p(e){return e instanceof l.c9}function y(e){return e instanceof n.lY}function d(e){return e instanceof o.n}function g(e){return e instanceof i.k}const f=1e3;const h={point:"point",polygon:"polygon",polyline:"polyline",multipoint:"multipoint",extent:"extent",esriGeometryPoint:"point",esriGeometryPolygon:"polygon",esriGeometryPolyline:"polyline",esriGeometryMultipoint:"multipoint",esriGeometryEnvelope:"extent",envelope:"extent"},m={point:"esriGeometryPoint",polygon:"esriGeometryPolygon",polyline:"esriGeometryPolyline",multipoint:"esriGeometryMultipoint",extent:"esriGeometryEnvelope",esriGeometryPoint:"esriGeometryPoint",esriGeometryPolygon:"esriGeometryPolygon",esriGeometryPolyline:"esriGeometryPolyline",esriGeometryMultipoint:"esriGeometryMultipoint",esriGeometryEnvelope:"esriGeometryEnvelope",envelope:"esriGeometryEnvelope"},v={"small-integer":"esriFieldTypeSmallInteger",integer:"esriFieldTypeInteger",long:"esriFieldTypeLong",single:"esriFieldTypeSingle",double:"esriFieldTypeDouble",string:"esriFieldTypeString",date:"esriFieldTypeDate","date-only":"esriFieldTypeDateOnly","time-only":"esriFieldTypeTimeOnly","timestamp-offset":"esriFieldTypeTimestampOffset",oid:"esriFieldTypeOID",geometry:"esriFieldTypeGeometry",blob:"esriFieldTypeBlob",raster:"esriFieldTypeRaster",guid:"esriFieldTypeGUID","global-id":"esriFieldTypeGlobalID",xml:"esriFieldTypeXML","big-integer":"esriFieldTypeBigInteger",esriFieldTypeSmallInteger:"esriFieldTypeSmallInteger",esriFieldTypeInteger:"esriFieldTypeInteger",esriFieldTypeLong:"esriFieldTypeLong",esriFieldTypeSingle:"esriFieldTypeSingle",esriFieldTypeDouble:"esriFieldTypeDouble",esriFieldTypeString:"esriFieldTypeString",esriFieldTypeDate:"esriFieldTypeDate",esriFieldTypeDateOnly:"esriFieldTypeDateOnly",esriFieldTypeTimeOnly:"esriFieldTypeTimeOnly",esriFieldTypeTimestampOffset:"esriFieldTypeTimestampOffset",esriFieldTypeOID:"esriFieldTypeOID",esriFieldTypeGeometry:"esriFieldTypeGeometry",esriFieldTypeBlob:"esriFieldTypeBlob",esriFieldTypeRaster:"esriFieldTypeRaster",esriFieldTypeGUID:"esriFieldTypeGUID",esriFieldTypeGlobalID:"esriFieldTypeGlobalID",esriFieldTypeXML:"esriFieldTypeXML",esriFieldTypeBigInteger:"esriFieldTypeBigInteger"};function T(e){return void 0===e?"":e=(e=(e=e.replace(/\/featureserver\/[0-9]*/i,"/FeatureServer")).replace(/\/mapserver\/[0-9]*/i,"/MapServer")).split("?")[0]}function S(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});const r="boolean"==typeof t.cycles&&t.cycles,n=t.cmp&&(o=t.cmp,function(e){return function(t,r){const n={key:t,value:e[t]},i={key:r,value:e[r]};return o(n,i)}});var o;const i=[];return function e(t){var o;if(null!==(o=t)&&void 0!==o&&o.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0===t)return;if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);let s,l;if(Array.isArray(t)){for(l="[",s=0;s<t.length;s++)s&&(l+=","),l+=e(t[s])||"null";return l+"]"}if(null===t)return"null";if(i.includes(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}const a=i.push(t)-1,u=Object.keys(t).sort(null===n||void 0===n?void 0:n(t));for(l="",s=0;s<u.length;s++){const r=u[s],n=e(t[r]);n&&(l&&(l+=","),l+=JSON.stringify(r)+":"+n)}return i.splice(a,1),"{"+l+"}"}(e)}function w(e){switch(e.type){case"catalog":case"csv":case"feature":case"geojson":case"knowledge-graph-sublayer":case"oriented-imagery":case"subtype-group":case"wfs":return!0;default:return!1}}function F(e){switch(e.type){case"catalog-footprint":case"subtype-sublayer":return!0;default:return w(e)}}},66240:(e,t,r)=>{r.d(t,{X:()=>o,_:()=>i});var n=r(9861);function o(e){if("string"==typeof e)return e.toLowerCase();if("name"in e)return e.name.toLowerCase();if("string"!=typeof e.value)throw new n.D$(null,"InvalidIdentifier",null);return e.value.toLowerCase()}const i=Object.freeze({aborted:!1})},73272:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(6326),o=r(42553),i=r(46053),s=r(87990);let l=class extends o.o{constructor(e){super(e),this.text=null,this.detectedLanguage="en",this.detectedLanguageScore=-1}};(0,n.Cg)([(0,i.MZ)({type:String,json:{write:!0}})],l.prototype,"key",void 0),(0,n.Cg)([(0,i.MZ)({type:String,json:{write:!0}})],l.prototype,"text",void 0),(0,n.Cg)([(0,i.MZ)({type:String,json:{read:{source:"detectedLanguage.language"},write:{target:"detectedLanguage.language"}}})],l.prototype,"detectedLanguage",void 0),(0,n.Cg)([(0,i.MZ)({type:Number,json:{read:{source:"detectedLanguage.score"},write:{target:"detectedLanguage.score"}}})],l.prototype,"detectedLanguageScore",void 0),(0,n.Cg)([(0,i.MZ)({type:Object,json:{write:!0}})],l.prototype,"translation",void 0),l=(0,n.Cg)([(0,s.$)("esri.rest.support.TranslateResult")],l)},84144:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(6326),o=r(42553),i=r(46053),s=r(87990);let l=class extends o.o{constructor(e){super(e)}};(0,n.Cg)([(0,i.MZ)({type:String,json:{write:!0}})],l.prototype,"key",void 0),(0,n.Cg)([(0,i.MZ)({type:String,json:{write:!0}})],l.prototype,"text",void 0),l=(0,n.Cg)([(0,s.$)("esri.rest.support.TranslateContent")],l)}}]);
//# sourceMappingURL=6695.1be45eb5.chunk.js.map