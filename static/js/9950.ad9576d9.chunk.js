"use strict";(self.webpackChunktest_app=self.webpackChunktest_app||[]).push([[7995,9950],{1484:(e,t,s)=>{s.d(t,{A:()=>n});var r=s(97255);class n{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.lengths=null!==e&&void 0!==e?e:[],this.coords=null!==t&&void 0!==t?t:[]}static fromJSON(e){return new n(e.lengths,e.coords)}static fromRect(e){const[t,s,r,i]=e,a=r-t,o=i-s;return new n([5],[t,s,a,0,0,o,-a,0,0,-o])}get isPoint(){return 0===this.lengths.length&&this.coords.length>=2}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((e,t)=>e+t)}get usedMemory(){return 64+(0,r.Qf)(this.lengths,this.coords)}area(){let e=0,t=0;if(!this.lengths.length)return 0;for(let s=0;s<this.lengths.length;s++){const r=this.lengths[s];if(r<3)continue;let n=this.coords[2*t],i=this.coords[2*t+1];for(let s=1;s<r;s+=1){const r=this.coords[2*(s+t)],a=this.coords[2*(s+t)+1];e+=-.5*(r-n)*(a+i),n=r,i=a}t+=r}return e}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let s=0;s<this.lengths.length;s++){const r=this.lengths[s];for(let s=0;s<r;s++)e(this.coords[2*(s+t)],this.coords[2*(s+t)+1]);t+=r}}deltaDecode(){const e=this.clone(),{coords:t,lengths:s}=e;let r=0;for(const n of s){for(let e=1;e<n;e++)t[2*(r+e)]+=t[2*(r+e)-2],t[2*(r+e)+1]+=t[2*(r+e)-1];r+=n}return e}clone(e){if(0===this.lengths.length)return new n([],[this.coords[0],this.coords[1]]);const t=2*(0===this.lengths.length?1:this.lengths.reduce((e,t)=>e+t)),s=this.coords.slice(0,t);return e?(e.set(s),new n(this.lengths,e)):new n(Array.from(this.lengths),Array.from(s))}}},5845:(e,t,s)=>{s.d(t,{A:()=>c});var r=s(6326),n=s(69098),i=s(42553),a=s(46053),o=(s(81806),s(76460),s(47249),s(6409)),u=s(87990),l=s(9392);let c=class extends((0,n.OU)(i.o)){constructor(e){super(e),this.type="local",this.origin=(0,l.vt)()}};(0,r.Cg)([(0,o.e)({local:"local"},{readOnly:!0})],c.prototype,"type",void 0),(0,r.Cg)([(0,a.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],c.prototype,"origin",void 0),c=(0,r.Cg)([(0,u.$)("esri.geometry.support.MeshLocalVertexSpace")],c)},8298:(e,t,s)=>{s.d(t,{F:()=>r,P:()=>n});const r={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCentroidOnDegeneratedQuantizedGeometry:!0,supportsCacheHint:!0,supportsCurrentUser:!1,supportsDegeneratedQuantizedGeometry:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsPaginationOnAggregatedQueries:!1,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!0,supportsReturnMesh:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,maxUniqueIDCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0,supportsTrueCurve:!1},n={supportsDate:!0,supportsFixedInterval:!0,supportsAutoInterval:!0,supportsFixedBoundaries:!0,supportsStackBy:!0,supportsSplitBy:!0,supportsSnapToData:!1,supportsReturnFullIntervalBin:!1,supportsFirstDayOfWeek:!1,supportsNormalization:!0,supportedStatistics:{count:!0,sum:!0,avg:!0,var:!0,stddev:!0,min:!0,max:!0,percentileContinuous:!0,percentileDiscrete:!0,envelope:!0,centroid:!0,convexHull:!0},supportedNormalizationTypes:{field:!0,log:!0,naturalLog:!0,percentOfTotal:!0,squareRoot:!0}}},14148:(e,t,s)=>{s.r(t),s.d(t,{default:()=>U});var r=s(89379),n=s(6326),i=s(86560),a=s(3825),o=s(18690),u=s(50076),l=s(81806),c=s(45802),d=s(49304),p=s(76460),h=s(48611),y=s(50346),g=s(68134),f=s(90534),m=s(49723),v=s(46053),A=s(87990),I=s(76797),w=s(13312),q=s(14894),S=s(99773),b=s(57045),F=s(38911),O=s(40296),E=s(17872),N=s(13096),R=s(91447),T=s(19463),_=s(14009),x=s(10290),M=s(97015),C=s(59187),P=s(35298);const Q=new c.J({originalAndCurrentFeatures:"original-and-current-features",none:"none"}),D=new c.J({Started:"published",Publishing:"publishing",Stopped:"unavailable"});let U=class extends d.x_{constructor(e){super(e),this.type="feature-layer",this.supportedSourceTypes=new Set(["Feature Layer","Oriented Imagery Layer","Table","Catalog Layer"]),this.refresh=(0,y.sg)(async()=>{var e,t;await this.load();const s=null===(e=this.sourceJSON.editingInfo)||void 0===e?void 0:e.lastEditDate;if(null==s)return{dataChanged:!0,updates:{}};try{await this._fetchService(null)}catch(n){return{dataChanged:!0,updates:{}}}const r=s!==(null===(t=this.sourceJSON.editingInfo)||void 0===t?void 0:t.lastEditDate);return{dataChanged:r,updates:r?{editingInfo:this.sourceJSON.editingInfo,extent:this.sourceJSON.extent}:null}}),this._ongoingAssetUploads=new Map}load(e){const t=this.layer.sourceJSON,s=this._fetchService(t,(0,r.A)({},e)).then(()=>this.layer.setUserPrivileges(this.sourceJSON.serviceItemId,e)).then(()=>this._ensureLatestMetadata(e));return this.addResolvingPromise(s),Promise.resolve(this)}initialize(){this.addHandles([(0,g.wB)(()=>{const e=this.layer;return e&&"lastEditsEventDate"in e?e.lastEditsEventDate:null},e=>this._handleLastEditsEventChange(e))])}destroy(){this._removeEditInterceptor()}get queryTask(){var e,t;const{capabilities:s,parsedUrl:r,gdbVersion:n,spatialReference:i,fieldsIndex:a,uniqueIdFields:o}=this.layer,u="infoFor3D"in this.layer?this.layer.infoFor3D:null,c="dynamicDataSource"in this.layer?this.layer.dynamicDataSource:null,d=(0,l.A)("featurelayer-pbf")&&(null===s||void 0===s?void 0:s.query.supportsFormatPBF)&&null==u;return new E.A({dynamicDataSource:c,fieldsIndex:a,gdbVersion:n,infoFor3D:u,pbfSupported:d,queryAttachmentsSupported:null!==(e=null===s||void 0===s||null===(t=s.operations)||void 0===t?void 0:t.supportsQueryAttachments)&&void 0!==e&&e,sourceSpatialReference:i,uniqueIdFields:o,url:r.path})}async addAttachment(e,t){await this.load();const{layer:s}=this;await(0,R.VA)(s,"editing");const r=e.attributes[s.objectIdField],n=s.parsedUrl.path+"/"+r+"/addAttachment",i=this._getLayerRequestOptions(),o=this._getFormDataForAttachment(t,i.query);try{const e=await(0,a.A)(n,{body:o});return(0,F.CU)(e.data.addAttachmentResult)}catch(u){throw this._createAttachmentErrorResult(r,u)}}async updateAttachment(e,t,s){await this.load();const{layer:r}=this;await(0,R.VA)(r,"editing");const n=e.attributes[r.objectIdField],i=r.parsedUrl.path+"/"+n+"/updateAttachment",o=this._getLayerRequestOptions({query:{attachmentId:t}}),u=this._getFormDataForAttachment(s,o.query);try{const e=await(0,a.A)(i,{body:u});return(0,F.CU)(e.data.updateAttachmentResult)}catch(l){throw this._createAttachmentErrorResult(n,l)}}async applyEdits(e,t){var s,r,n,i,l;await this.load();const{layer:c}=this;await(0,R.VA)(c,"editing");const d="infoFor3D"in c?c.infoFor3D:null,p=null!=d,h=p||null!==(s=null===t||void 0===t?void 0:t.globalIdUsed)&&void 0!==s&&s,y=p?await this._uploadMeshesAndGetAssetMapEditsJSON(e):null,g=null!==(r=null===(n=e.addFeatures)||void 0===n?void 0:n.map(e=>(0,F.jR)(this.layer,e,d)))&&void 0!==r?r:[],f=(await Promise.all(g)).filter(o.Ru),m=null!==(i=null===(l=e.updateFeatures)||void 0===l?void 0:l.map(e=>(0,F.jR)(this.layer,e,d)))&&void 0!==i?i:[],v=(await Promise.all(m)).filter(o.Ru),A=(0,F.TG)(this.layer,e.deleteFeatures,h);(0,x.u)(f,v,c.spatialReference);const I=await(0,F.ZI)(this.layer,e),w=c.capabilities.editing.supportsAsyncApplyEdits&&p,q=(null===t||void 0===t?void 0:t.gdbVersion)||c.gdbVersion,S={gdbVersion:q,rollbackOnFailure:null===t||void 0===t?void 0:t.rollbackOnFailureEnabled,useGlobalIds:h,returnEditMoment:null===t||void 0===t?void 0:t.returnEditMoment,usePreviousEditMoment:null===t||void 0===t?void 0:t.usePreviousEditMoment,async:w};await(0,P.ZJ)(this.layer.url,q,!0);const b=(0,P.w5)(this.layer.url,q||null);if(await(0,P.We)(c.url,q,c.historicMoment))throw new u.A("feature-layer-source:historic-version","Editing a historic version is not allowed");null!==t&&void 0!==t&&t.returnServiceEditsOption?(S.edits=JSON.stringify([{id:c.layerId,adds:f.length?f:null,updates:v.length?v:null,deletes:A.length?A:null,attachments:I,assetMaps:y}]),S.returnServiceEditsOption=Q.toJSON(null===t||void 0===t?void 0:t.returnServiceEditsOption),S.returnServiceEditsInSourceSR=null===t||void 0===t?void 0:t.returnServiceEditsInSourceSR):(S.adds=f.length?JSON.stringify(f):null,S.updates=v.length?JSON.stringify(v):null,S.deletes=A.length?h?JSON.stringify(A):A.join(","):null,S.attachments=I&&JSON.stringify(I),S.assetMaps=null!=y?JSON.stringify(y):void 0);const O=this._getLayerRequestOptions({method:"post",query:S});b&&(O.authMode="immediate",O.query.returnEditMoment=!0,O.query.sessionId=P.TA);const E=null!==t&&void 0!==t&&t.returnServiceEditsOption?c.url:c.parsedUrl.path;let N;try{N=w?await this._asyncApplyEdits(E+"/applyEdits",O):await(0,a.A)(E+"/applyEdits",O)}catch(T){if(!(0,F.F0)(T))throw T;O.authMode="immediate",N=w?await this._asyncApplyEdits(E+"/applyEdits",O):await(0,a.A)(E+"/applyEdits",O)}return this._createEditsResult(N)}async deleteAttachments(e,t){await this.load();const{layer:s}=this;await(0,R.VA)(s,"editing");const r=e.attributes[s.objectIdField],n=s.parsedUrl.path+"/"+r+"/deleteAttachments";try{return(await(0,a.A)(n,this._getLayerRequestOptions({query:{attachmentIds:t.join(",")},method:"post"}))).data.deleteAttachmentResults.map(F.CU)}catch(i){throw this._createAttachmentErrorResult(r,i)}}fetchRecomputedExtents(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.signal;return this.load({signal:t}).then(async()=>{const t=this._getLayerRequestOptions((0,r.A)((0,r.A)({},e),{},{query:{returnUpdates:!0}})),{layerId:s,url:n}=this.layer,{data:i}=await(0,a.A)("".concat(n,"/").concat(s),t),{id:o,extent:u,fullExtent:l,timeExtent:c}=i,d=u||l;return{id:o,fullExtent:d&&I.A.fromJSON(d),timeExtent:c&&C.A.fromJSON({start:c[0],end:c[1]})}})}async queryAttachments(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};await this.load();const s=this._getLayerRequestOptions(t);return this.queryTask.executeAttachmentQuery(e,s)}async queryFeatures(e,t){var s;await this.load();const n=await this.queryTask.execute(e,(0,r.A)((0,r.A)({},t),{},{query:this._createRequestQueryOptions(t)}));if(null!==(s=e.outStatistics)&&void 0!==s&&s.length&&n.features.length){const t=new Map;if(n.features.forEach(s=>{var r;const n=s.attributes;null===(r=e.outStatistics)||void 0===r||r.forEach(e=>{let{outStatisticFieldName:s}=e;if(s){const e=s.toLowerCase();e&&e in n&&s!==e&&(n[s]=n[e],delete n[e],t.set(e,s))}})}),null!=n.fields)for(const e of n.fields){const s=t.get(e.name.toLowerCase());null!=s&&(e.name=s)}}return n}async queryFeaturesJSON(e,t){return await this.load(),this.queryTask.executeJSON(e,(0,r.A)((0,r.A)({},t),{},{query:this._createRequestQueryOptions(t)}))}async queryObjectIds(e,t){return await this.load(),this.queryTask.executeForIds(e,(0,r.A)((0,r.A)({},t),{},{query:this._createRequestQueryOptions(t)}))}async queryFeatureCount(e,t){return await this.load(),this.queryTask.executeForCount(e,(0,r.A)((0,r.A)({},t),{},{query:this._createRequestQueryOptions(t)}))}async queryExtent(e,t){return await this.load(),this.queryTask.executeForExtent(e,(0,r.A)((0,r.A)({},t),{},{query:this._createRequestQueryOptions(t)}))}async queryRelatedFeatures(e,t){return await this.load(),this.queryTask.executeRelationshipQuery(e,(0,r.A)((0,r.A)({},t),{},{query:this._createRequestQueryOptions(t)}))}async queryRelatedFeaturesCount(e,t){return await this.load(),this.queryTask.executeRelationshipQueryForCount(e,(0,r.A)((0,r.A)({},t),{},{query:this._createRequestQueryOptions(t)}))}async queryPivot(e,t){return await this.load(),this.queryTask.executePivotQuery(e,(0,r.A)((0,r.A)({},t),{},{query:this._createRequestQueryOptions(t)}))}async queryTopFeatures(e,t){return await this.load(),this.queryTask.executeTopFeaturesQuery(e,(0,r.A)((0,r.A)({},t),{},{query:this._createRequestQueryOptions(t)}))}async queryAttributeBins(e,t){return await this.load(),this.queryTask.executeAttributeBinsQuery(e,(0,r.A)((0,r.A)({},t),{},{query:this._createRequestQueryOptions(t)}))}async queryTopObjectIds(e,t){return await this.load(),this.queryTask.executeForTopIds(e,(0,r.A)((0,r.A)({},t),{},{query:this._createRequestQueryOptions(t)}))}async queryTopExtents(e,t){return await this.load(),this.queryTask.executeForTopExtents(e,(0,r.A)((0,r.A)({},t),{},{query:this._createRequestQueryOptions(t)}))}async queryTopCount(e,t){return await this.load(),this.queryTask.executeForTopCount(e,(0,r.A)((0,r.A)({},t),{},{query:this._createRequestQueryOptions(t)}))}async fetchPublishingStatus(){if(!(0,N.Wo)(this.layer.url))return"unavailable";const e=(0,f.fj)(this.layer.url,"status"),t=await(0,a.A)(e,{query:{f:"json"}});return D.fromJSON(t.data.status)}async uploadAssets(e,t){const{uploadAssets:r}=await s.e(9845).then(s.bind(s,99845));return r(e,{layer:this.layer,ongoingUploads:this._ongoingAssetUploads},t)}_handleLastEditsEventChange(e){var t,s;const r=this.layer;if(null==e||!("capabilities"in r)||!("effectiveCapabilities"in r))return;if(null!==(t=r.capabilities)&&void 0!==t&&null!==(t=t.operations)&&void 0!==t&&t.supportsEditing||null===(s=r.effectiveCapabilities)||void 0===s||null===(s=s.operations)||void 0===s||!s.supportsEditing)return;const n=r.url;null!=n&&("layerId"in r&&(0,f.fj)(n,r.layerId.toString()),this._getOrCreateEditInterceptor(n).before=t=>{var s;const r=null!==(s=t.requestOptions.method)&&void 0!==s?s:"auto";if("auto"===r||"head"===r){var n;const s=null!==(n=t.requestOptions.query)&&void 0!==n?n:{};s._ts=e.getTime(),t.requestOptions.query=s}})}_getOrCreateEditInterceptor(e){return null==this._editInterceptor&&(this._editInterceptor={urls:e},i.A.request.internalInterceptors.push(this._editInterceptor)),this._editInterceptor}_removeEditInterceptor(){null!=this._editInterceptor&&((0,o.TF)(i.A.request.internalInterceptors,this._editInterceptor),this._editInterceptor=null)}async _asyncApplyEdits(e,t){const s=(await(0,a.A)(e,t)).data.statusUrl;for(;;){const e=(await(0,a.A)(s,{query:{f:"json"},responseType:"json"})).data;switch(e.status){case"Completed":return(0,a.A)(e.resultUrl,{query:{f:"json"},responseType:"json"});case"CompletedWithErrors":throw new u.A("async-applyEdits-failed","asynchronous applyEdits call failed.");case"Failed ImportChanges":case"InProgress":case"Pending":case"ExportAttachments":case"ExportChanges":case"ExportingData":case"ExportingSnapshot":case"ImportAttachments":case"ProvisioningReplica":case"UnRegisteringReplica":break;default:throw new u.A("async-applyEdits-failed","asynchronous applyEdits call failed (undefined response status)")}await(0,y.Pl)(J)}}_createRequestQueryOptions(e){const t=(0,r.A)((0,r.A)({},this.layer.customParameters),{},{token:this.layer.apiKey},null===e||void 0===e?void 0:e.query);return this.layer.datesInUnknownTimezone&&(t.timeReferenceUnknownClient=!0),t}async _fetchService(e,t){if(!e){const s={};(0,l.A)("featurelayer-advanced-symbols")&&(s.returnAdvancedSymbols=!0),(null===t||void 0===t?void 0:t.cacheBust)&&(s._ts=Date.now());const{data:r}=await(0,a.A)(this.layer.parsedUrl.path,this._getLayerRequestOptions({query:s,signal:null===t||void 0===t?void 0:t.signal}));e=r}this.layer.applyPreferredHost(e),this.sourceJSON=await this._patchServiceJSON(e,null===t||void 0===t?void 0:t.signal);const s=e.type;if(!this.supportedSourceTypes.has(s))throw new u.A("feature-layer-source:unsupported-type",'Source type "'.concat(s,'" is not supported'))}async _patchServiceJSON(e,t){var s;if("Table"!==e.type&&e.geometryType&&(null===e||void 0===e||null===(s=e.drawingInfo)||void 0===s||!s.renderer)&&!e.defaultSymbol){const t=(0,O.F0)(e.geometryType).renderer;(0,h.sM)("drawingInfo.renderer",t,e)}if("esriGeometryMultiPatch"===e.geometryType&&e.infoFor3D&&(e.geometryType="mesh"),null==e.extent)try{const{data:s}=await(0,a.A)(this.layer.url,this._getLayerRequestOptions({signal:t}));s.spatialReference&&(e.extent={xmin:0,ymin:0,xmax:0,ymax:0,spatialReference:s.spatialReference})}catch(r){(0,y.QP)(r)}return e}async _ensureLatestMetadata(e){if(this.layer.userHasUpdateItemPrivileges&&this.sourceJSON.cacheMaxAge>0)return this._fetchService(null,(0,r.A)((0,r.A)({},e),{},{cacheBust:!0}))}async _uploadMeshesAndGetAssetMapEditsJSON(e){const{addAssetFeatures:t}=e;if(null===t||void 0===t||!t.length)return null;if(await this._areAllAssetsAlreadyMapped(t))return null;const r=e.addFeatures.filter(e=>e.geometry);if(t.length!==r.length+e.updateFeatures.length)throw new u.A("feature-layer-source:unsupported-mesh-edits","Mixing attribute only edits with mesh geometry edits is not currently supported");const n=new Array,i=new Map;for(const o of t){const{geometry:e}=o,{vertexSpace:t}=e;if((0,S.Hq)(t))n.push(e);else{var a;const t=e.origin,{convertMeshVertexSpace:r}=await Promise.all([s.e(8105),s.e(9996),s.e(530)]).then(s.bind(s,37440)),u=await r(e,new q.A({origin:[t.x,t.y,null!==(a=t.z)&&void 0!==a?a:0]}));i.set(u,e),o.geometry=u,n.push(u)}}await this.uploadAssets(n);for(const[s,o]of i)o.addExternalSources(s.metadata.externalSources.items);return{adds:this._getAssetMapEditsJSON(t),updates:[],deletes:[]}}_getAssetMapEditsJSON(e){const t=new Array,s=this.layer.globalIdField,r=this.layer.parsedUrl;for(const i of e){var n;const e=i.geometry,{metadata:a}=e,o=a.getExternalSourcesOnService(r),u=i.getAttribute(s);if(0===o.length){p.A.getLogger(this).error("Skipping feature ".concat(u,". The mesh it is associated with has not been uploaded to the service and cannot be mapped to it."));continue}const{source:l}=null!==(n=o.find(b.dK))&&void 0!==n?n:o[0];for(const s of l.assets)1===s.parts.length?t.push({globalId:(0,m.yS)(),parentGlobalId:u,assetName:s.assetName,assetHash:s.parts[0].partHash,flags:[]}):p.A.getLogger(this).error("Skipping asset ".concat(s.assetName,". It does not have exactly one part, so we cannot map it to a feature."))}return t}_createEditsResult(e){const t=e.data,{layerId:s}=this.layer,r=[];let n=null;if(Array.isArray(t))for(const l of t){var i,a,o;r.push({id:l.id,editedFeatures:l.editedFeatures}),l.id===s&&(n={addResults:null!==(i=l.addResults)&&void 0!==i?i:[],updateResults:null!==(a=l.updateResults)&&void 0!==a?a:[],deleteResults:null!==(o=l.deleteResults)&&void 0!==o?o:[],attachments:l.attachments,editMoment:l.editMoment})}else n=t;const u=(0,F.mP)(n);if(r.length>0){u.editedFeatureResults=[];for(const e of r){const{editedFeatures:t}=e,s=null!==t&&void 0!==t&&t.spatialReference?new w.A(t.spatialReference):null;u.editedFeatureResults.push({layerId:e.id,editedFeatures:(0,F.pX)(t,s)})}}return u}_createAttachmentErrorResult(e,t){var s;const r=(null===(s=t.details.messages)||void 0===s?void 0:s[0])||t.message,n=t.details.httpStatus||t.details.messageCode;return{objectId:e,globalId:null,error:new u.A("feature-layer-source:attachment-failure",r,{code:n})}}_getFormDataForAttachment(e,t){const s=e instanceof FormData?e:e&&e.elements?new FormData(e):null;if(s)for(const r in t){const e=t[r];null!=e&&(s.set?s.set(r,e):s.append(r,e))}return s}_getLayerRequestOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{layer:t,layer:{parsedUrl:s,gdbVersion:n}}=this;return(0,r.A)((0,r.A)({},e),{},{query:(0,r.A)((0,r.A)({gdbVersion:n,layer:"dynamicDataSource"in t&&t.dynamicDataSource?JSON.stringify({source:t.dynamicDataSource}):void 0},s.query),{},{f:"json"},this._createRequestQueryOptions(e)),responseType:"json"})}async _areAllAssetsAlreadyMapped(e){const{layer:t}=this,{globalIdField:s,parsedUrl:r}=t,n="infoFor3D"in t?t.infoFor3D:null;if(null==n||null==s)return!1;const i=(0,T.JZ)(n);if(null==i)return!1;const a=(0,f.fj)(r.path,"../".concat(i.id)),u=new Array;for(const o of e){if(!(o.geometry.metadata.getExternalSourcesOnService(r).length>0))return!1;u.push(o)}const l=u.map(e=>e.getAttribute(s)).filter(o.Ru);if(0===l.length)return!1;const{assetMapFieldRoles:{parentGlobalId:c,assetHash:d}}=n,p=new M.A({where:"".concat(c," IN (").concat(l.map(e=>"'".concat(e,"'")),")"),outFields:[d,c],returnGeometry:!1}),h=await(0,_.s)(a,p),{features:y}=h;return 0!==y.length&&!u.some(e=>{const t=e.getAttribute(s);if(!t)return!0;const{metadata:n}=e.geometry,i=y.filter(e=>e.getAttribute(c)===t);if(0===i.length)return!0;const a=i.map(e=>e.getAttribute(d));return n.getExternalSourcesOnService(r).flatMap(e=>{let{source:t}=e;return t.assets.flatMap(e=>e.parts.map(e=>e.partHash))}).some(e=>a.every(t=>e!==t))})}};(0,n.Cg)([(0,v.MZ)()],U.prototype,"type",void 0),(0,n.Cg)([(0,v.MZ)({constructOnly:!0})],U.prototype,"layer",void 0),(0,n.Cg)([(0,v.MZ)({constructOnly:!0})],U.prototype,"supportedSourceTypes",void 0),(0,n.Cg)([(0,v.MZ)({readOnly:!0})],U.prototype,"queryTask",null),U=(0,n.Cg)([(0,A.$)("esri.layers.graphics.sources.FeatureLayerSource")],U);const J=1e3},14894:(e,t,s)=>{s.d(t,{A:()=>d});var r,n,i=s(6326),a=s(69098),o=s(42553),u=s(46053),l=(s(81806),s(76460),s(47249),s(6409)),c=s(87990);let d=(n=r=class extends((0,a.OU)(o.o)){constructor(e){super(e),this.type="georeferenced",this.origin=null}},r.absolute=new n,r);(0,i.Cg)([(0,l.e)({georeferenced:"georeferenced"},{readOnly:!0})],d.prototype,"type",void 0),(0,i.Cg)([(0,u.MZ)({type:[Number],nonNullable:!1,json:{write:!0}})],d.prototype,"origin",void 0),d=n=(0,i.Cg)([(0,c.$)("esri.geometry.support.MeshGeoreferencedVertexSpace")],d)},20176:(e,t,s)=>{s.d(t,{N3:()=>u,Om:()=>o});var r=s(89379),n=s(97255),i=s(90321),a=s(1484);class o{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.geometry=e,this.attributes=t,this.centroid=s,this.objectId=r,this.displayId=n}static fromJSON(e){const t=e.geometry?a.A.fromJSON(e.geometry):null,s=e.centroid?a.A.fromJSON(e.centroid):null,r=e.objectId;return new o(t,e.attributes,s,r)}weakClone(){const e=new o(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e}clone(){var e,t;const s=null===(e=this.geometry)||void 0===e?void 0:e.clone(),n=new o(s,(0,r.A)({},this.attributes),null===(t=this.centroid)||void 0===t?void 0:t.clone(),this.objectId);return n.displayId=this.displayId,n}ensureCentroid(e){var t;return null!==(t=this.centroid)&&void 0!==t||(this.centroid=(0,i.Q)(new a.A,this.geometry,e.hasZ,e.hasM)),this.centroid}get usedMemory(){var e,t;return 128+(0,n.lM)(this.attributes)+(null!==(e=null===(t=this.geometry)||void 0===t?void 0:t.usedMemory)&&void 0!==e?e:0)}}function u(e){var t;return!(null===(t=e.geometry)||void 0===t||null===(t=t.coords)||void 0===t||!t.length)}},40296:(e,t,s)=>{s.d(t,{F0:()=>u,Vx:()=>d,e2:()=>h,f:()=>y});var r=s(89379),n=s(81806),i=s(53084),a=s(8298),o=s(44460);function u(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?o.Cb:"esriGeometryPolyline"===e?o.yM:o.WR}}}const l=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let c=1;function d(e,t){if((0,n.A)("esri-csp-restrictions"))return()=>(0,r.A)({[t]:null},e);try{let s="this".concat(p(t)," = null;");for(const t in e)s+="this".concat(p(t)," = ").concat(JSON.stringify(e[t]),";");const r=new Function("\n      return class AttributesClass$".concat(c++," {\n        constructor() {\n          ").concat(s,";\n        }\n      }\n    "))();return()=>new r}catch(s){return()=>(0,r.A)({[t]:null},e)}}function p(e){return l.test(e)?".".concat(e):'["'.concat(e,'"]')}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,i.o8)(e)}}]}function y(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryBins:!0,supportsQueryPivot:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:a.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:a.P,editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},57045:(e,t,s)=>{s.d(t,{Bq:()=>u,Qp:()=>o,WN:()=>f,dK:()=>m,eN:()=>h,fH:()=>g,in:()=>y,yr:()=>l});var r=s(3825),n=s(18690),i=(s(81806),s(50346)),a=s(19463);class o{constructor(e,t,s){this.assetName=e,this.assetMimeType=t,this.parts=s}equals(e){return this===e||this.assetName===e.assetName&&this.assetMimeType===e.assetMimeType&&(0,n.aI)(this.parts,e.parts,(e,t)=>e.equals(t))}isOnService(e){return this.parts.every(t=>t.isOnService(e))}makeHash(){let e="";for(const t of this.parts)e+=t.partHash;return e}async toBlob(e){const{parts:t}=this;if(1===t.length)return t[0].toBlob(e);const s=await Promise.all(t.map(t=>t.toBlob(e)));return(0,i.Te)(e),new Blob(s)}}class u{constructor(e,t){this.partUrl=e,this.partHash=t}equals(e){return this===e||this.partUrl===e.partUrl&&this.partHash===e.partHash}isOnService(e){return this.partUrl.startsWith("".concat(e.path,"/assets/"))}async toBlob(e){const{data:t}=await(0,r.A)(this.partUrl,{responseType:"blob"});return(0,i.Te)(e),t}}function l(e){return function(e){switch(null===e||void 0===e?void 0:e.type){case"client":return Array.isArray(e.files)?e.files.some(p):p(e.files);case"service":return e.assets.some(p);case"loadable":return!0;default:return!1}}(null===e||void 0===e?void 0:e.source)}const c=/^(model\/gltf\+json)|(model\/gltf-binary)$/,d=/\.(gltf|glb)/i;function p(e){if(e instanceof File){const{type:t,name:s}=e;return c.test(t)||d.test(s)}return c.test(e.assetMimeType)||d.test(e.assetName)}function h(e,t){if(!e)return!1;const{source:s}=e;return function(e,t){return"service"===e.type&&e.assets.every(e=>e.isOnService(t))}(s,t)}function y(e,t){if(e===t)return!0;const{source:s}=e,{source:r}=t;if(s===r)return!0;if("service"===s.type&&"service"===r.type){if(s.assets.length!==r.assets.length)return!1;const e=(e,t)=>e.assetName<t.assetName?-1:e.assetName>t.assetName?1:0,t=[...s.assets].sort(e),n=[...r.assets].sort(e);for(let s=0;s<t.length;++s)if(!t[s].equals(n[s]))return!1;return!0}return!1}function g(e,t){return e instanceof File?(0,a.rq)(e,t):(0,a.z$)(e.assetMimeType,e.assetName,t)}function f(e){switch(e.type){case"client":return Array.isArray(e.files)?e.files:[e.files];case"service":return e.assets;case"loadable":return}}function m(e){return!!e.original}},75146:(e,t,s)=>{s.d(t,{A:()=>r});class r{constructor(){this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new r;return e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}},90321:(e,t,s)=>{function r(e,t){return e?t?4:3:t?3:2}function n(e,t,s,n){if(null===t||void 0===t||!t.lengths.length)return null;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);const o=e.coords,u=[],l=s?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:c,coords:d}=t,p=r(s,n);let h=0;for(const r of c){const e=i(l,d,h,r,s,n);e&&u.push(e),h+=r*p}if(u.sort((e,t)=>{let r=e[2]-t[2];return 0===r&&s&&(r=e[4]-t[4]),r}),u.length){let e=6*u[0][2];o[0]=u[0][0]/e,o[1]=u[0][1]/e,s&&(e=6*u[0][4],o[2]=0!==e?u[0][3]/e:0),(o[0]<l[0]||o[0]>l[1]||o[1]<l[2]||o[1]>l[3]||s&&(o[2]<l[4]||o[2]>l[5]))&&(o.length=0)}if(!o.length){const e=t.lengths[0]?a(d,0,c[0],s,n):null;if(!e)return null;o[0]=e[0],o[1]=e[1],s&&e.length>2&&(o[2]=e[2])}return e}function i(e,t,s,n,i,a){const o=r(i,a);let u=s,l=s+o,c=0,d=0,p=0,h=0,y=0;for(let r=0,f=n-1;r<f;r++,u+=o,l+=o){const s=t[u],r=t[u+1],n=t[u+2],a=t[l],o=t[l+1],g=t[l+2];let f=s*o-a*r;h+=f,c+=(s+a)*f,d+=(r+o)*f,i&&(f=s*g-a*n,p+=(n+g)*f,y+=f),s<e[0]&&(e[0]=s),s>e[1]&&(e[1]=s),r<e[2]&&(e[2]=r),r>e[3]&&(e[3]=r),i&&(n<e[4]&&(e[4]=n),n>e[5]&&(e[5]=n))}if(h>0&&(h*=-1),y>0&&(y*=-1),!h)return null;const g=[c,d,.5*h];return i&&(g[3]=p,g[4]=.5*y),g}function a(e,t,s,n,i){const a=r(n,i);let d=t,p=t+a,h=0,y=0,g=0,f=0;for(let r=0,m=s-1;r<m;r++,d+=a,p+=a){const t=e[d],s=e[d+1],r=e[d+2],i=e[p],a=e[p+1],m=e[p+2],v=n?u(t,s,r,i,a,m):o(t,s,i,a);if(v)if(h+=v,n){const e=c(t,s,r,i,a,m);y+=v*e[0],g+=v*e[1],f+=v*e[2]}else{const e=l(t,s,i,a);y+=v*e[0],g+=v*e[1]}}return h>0?n?[y/h,g/h,f/h]:[y/h,g/h]:s>0?n?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function o(e,t,s,r){const n=s-e,i=r-t;return Math.sqrt(n*n+i*i)}function u(e,t,s,r,n,i){const a=r-e,o=n-t,u=i-s;return Math.sqrt(a*a+o*o+u*u)}function l(e,t,s,r){return[e+.5*(s-e),t+.5*(r-t)]}function c(e,t,s,r,n,i){return[e+.5*(r-e),t+.5*(n-t),s+.5*(i-s)]}s.d(t,{Q:()=>n})},97255:(e,t,s)=>{s.d(t,{$B:()=>n,Qf:()=>l,Qh:()=>o,RS:()=>i,ez:()=>p,i5:()=>h,lM:()=>a,qK:()=>d});var r=s(78393);function n(e){return 32+e.length}const i=16;function a(e){if(!e)return 0;let t=d;for(const s in e)e.hasOwnProperty(s)&&(t+=u(e[s],!1));return t}function o(e){if(!e)return 0;if("number"==typeof e[0])return l(e);if(Array.isArray(e))return function(e){const t=e.length;if(0===t||"number"==typeof e[0])return c(e,8);let s=p;for(let r=0;r<t;r++)s+=u(e[r]);return s}(e);let t=d;for(const s in e)e.hasOwnProperty(s)&&(t+=u(e[s]));return t}function u(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];switch(typeof e){case"object":return t?o(e):d;case"string":return n(e);case"number":return i;case"boolean":return 4;default:return 8}}function l(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.reduce((e,t)=>e+(t?(0,r.iu)(t)?t.byteLength+h:Array.isArray(t)?c(t,i):0:0),0)}function c(e,t){return p+e.length*t}const d=32,p=16,h=145},99773:(e,t,s)=>{s.d(t,{CK:()=>l,E9:()=>o,Hq:()=>u,MW:()=>c,TE:()=>d,yJ:()=>p});var r=s(20664),n=s(19247),i=s(14894),a=s(5845);function o(e){return null==e.origin}function u(e){return null!=e.origin}function l(e){return u(e.vertexSpace)}function c(e,t){if(!u(e))return null;const[s,r,i]=e.origin;return new n.A({x:s,y:r,z:i,spatialReference:t})}function d(e,t){var s;const{x:r,y:n,z:o,spatialReference:u}=e,l=[r,n,null!==o&&void 0!==o?o:0];return"local"===(null!==(s=null===t||void 0===t?void 0:t.vertexSpace)&&void 0!==s?s:function(e){return e.isGeographic||e.isWebMercator?"local":"georeferenced"}(u))?new a.A({origin:l}):new i.A({origin:l})}function p(e,t){return e.type===t.type&&(e.origin===t.origin||null!=e.origin&&null!=t.origin&&(0,r.q)(e.origin,t.origin))}}}]);
//# sourceMappingURL=9950.ad9576d9.chunk.js.map